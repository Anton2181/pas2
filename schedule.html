<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tango Scheduler - Schedule</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body>
    <div class="top-nav">
        <div class="nav-left">
            <div class="nav-brand">
                <div>Warsaw Tango Partyka</div>
                <div id="project-date" class="project-date" title="Double-click to edit">December 2025</div>
            </div>
            <div class="nav-links">
                <a href="schedule.html" class="nav-link active">Schedule</a>
                <a href="team.html" class="nav-link">Team Members</a>
                <a href="task-groups.html" class="nav-link">Task Groups</a>
            </div>
        </div>
        <div class="nav-actions">
            <button id="global-save-btn" class="global-action-btn" title="Save All Data">ðŸ’¾</button>
            <button id="global-load-btn" class="global-action-btn" title="Load All Data">ðŸ“‚</button>
        </div>
    </div>
    <input type="file" id="global-file-input" accept=".json" style="display: none;">

    <link rel="stylesheet" href="css/schedule-layout.css">
    <link rel="stylesheet" href="css/rules-monitoring.css">

    <div class="schedule-container">
        <!-- Left Panel: Assignment -->
        <div id="assignment-panel" class="panel">
            <div class="panel-header">
                <span>Assignment</span>
                <div class="panel-actions">
                    <!-- Placeholder for actions -->
                </div>
            </div>
            <div class="panel-content">
                <p style="color: #999; text-align: center; margin-top: 20px;">Assignment View Placeholder</p>
            </div>
        </div>

        <!-- Vertical Splitter -->
        <div id="v-splitter" class="splitter splitter-vertical"></div>

        <!-- Right Container -->
        <div id="right-container">
            <!-- Top Right: Effort Graph -->
            <div id="effort-panel" class="panel">
                <div class="panel-header">Effort Graph</div>
                <div id="effort-panel-content" class="panel-content" style="padding: 0; overflow: hidden;">
                    <!-- Canvas injected here -->
                </div>
            </div>

            <!-- Horizontal Splitter -->
            <div id="h-splitter" class="splitter splitter-horizontal"></div>

            <!-- Bottom Right: Rules Monitoring -->
            <div id="rules-panel" class="panel">
                <div class="panel-header">Rules Monitoring</div>
                <div class="panel-content">
                    <p style="color: #999; text-align: center; margin-top: 20px;">Rules Monitoring Placeholder</p>
                </div>
            </div>
        </div>
    </div>

    <script src="js/schedule-importer.js"></script>
    <script src="js/data.js"></script>
    <script src="js/schedule-preview.js"></script>
    <script src="js/schedule-aggregation.js"></script>
    <script src="js/schedule-layout.js"></script>
    <script src="js/effort-graph.js"></script>
    <script src="js/rules-monitoring.js"></script>

    <script src="js/global-storage.js"></script>
    <script>
        // Setup date editable
        function setupDateEditable() {
            const dateEl = document.getElementById('project-date');
            const storedDate = localStorage.getItem('project_date');
            if (storedDate) {
                dateEl.textContent = storedDate;
            }

            dateEl.addEventListener('dblclick', () => {
                const currentText = dateEl.textContent;
                const input = document.createElement('input');
                input.value = currentText;

                input.onblur = () => {
                    const newValue = input.value || 'December 2025';
                    dateEl.textContent = newValue;
                    localStorage.setItem('project_date', newValue);
                };

                input.onkeydown = (e) => {
                    if (e.key === 'Enter') input.blur();
                };

                dateEl.textContent = '';
                dateEl.appendChild(input);
                input.focus();
            });
        }

        setupDateEditable();
        initGlobalStorage();

        // Load data to populate graph
        if (typeof loadData === 'function') {
            loadData().then(() => {
                console.log('Data loaded for schedule view');
            });
        }
    </script>
</body>

</html>